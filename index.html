<html>
	<head>
		<title>API of Country, State and Cities | CodeIgniter|php</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
	</head>
	<body>
		<div class="container">
			<br />
			<br />
			<h2 align="center"><a href="http://www.webslesson.info/2016/02/dynamically-add-remove-input-fields-in-php-with-jquery-ajax.html" title="Dynamically Add or Remove input fields in PHP with JQuery">Dynamically Add or Remove input fields in PHP with JQuery</a></h2><br />
			<div class="form-group">
				<form name="add_name" id="add_name">
					<div class="table-responsive">
						<table class="table table-bordered" id="dynamic_field">
							<tr>
								<td><input type="text" name="name[]" placeholder="Enter your Name" class="form-control name_list" /></td>
								<td><button type="button" name="add" id="add" class="btn btn-success">Add More</button></td>
							</tr>
						</table>
						<input type="button" name="submit" id="submit" class="btn btn-info" value="Submit" />
					</div>
				</form>
				<form>	
					<div class="form-group">
    					<label for="country">Countries</label>				
						<select class="form-control" name="country" id="country">
							<option value="">--Select Country--</option>
							<?php 
								$data = file_get_contents('http://localhost/common-panel/api/api/countries');							
								$json_data = json_decode($data,true);
								if($json_data['response_code'] == '200' && $json_data['response_msg']='success'){
									//var_dump(count($data));
								for ($i=0; $i < sizeof($json_data['countries']); $i++) { 
							?>
							<option value="<?= @$json_data['countries'][$i]['id'] ?>"><?= ucfirst(@$json_data['countries'][$i]['name']) ?></option>
							<?php } }  ?>
						</select>
					</div>
					<div class="form-group">
    					<label for="state">States</label>	
						<select class="form-control text-capitalize" name="state" id="state">
						</select>
					</div>
					<div class="form-group">
    					<label for="city">Cities</label>	
						<select class="form-control text-capitalize" name="city" id="city">
						</select>
					</div>
				</form>
			</div>
		</div>
	</body>
</html>

<script>
$(document).ready(function(){
	var i=1;
	$('#add').click(function(){
		i++;
		$('#dynamic_field').append('<tr id="row'+i+'"><td><input type="text" name="name[]" placeholder="Enter your Name" class="form-control name_list" /></td><td><button type="button" name="remove" id="'+i+'" class="btn btn-danger btn_remove">X</button></td></tr>');
	});
	
	$(document).on('click', '.btn_remove', function(){
		var button_id = $(this).attr("id"); 
		$('#row'+button_id+'').remove();
	});
	
	$('#submit').click(function(){		
		$.ajax({
			url:"name.php",
			method:"POST",
			data:$('#add_name').serialize(),
			success:function(data)
			{
				alert(data);
				$('#add_name')[0].reset();
			}
		});
	});
	
});
</script>

<script type="text/javascript">
	$("#country").change(function()
	    {
	        var country_id =$(this).val().toString();
	        $.ajax({
			    url:"http://localhost/common-panel/api/api/states/"+country_id,
			    type:"GET",
			    success: function(data){
			    	//(data['states'][0]['name']);
			    	var state_list = '';
			    	state_list ="<option value=''>--Select State--</option>";
			        for (var i = 0; i < data['states'].length-1; i++){
			    		state_list += "<option value="+data['states'][i]['id']+">"+data['states'][i]['name']+"</option>";
			    	}	
			  		$('#state').html(state_list);		      
			    },
			    error:function(data){
			        alert("error");
			    }
			});
	    });
	$("#state").change(function()
	    {
	        var state =$(this).val().toString();
	        $.ajax({
			    url:"http://localhost/common-panel/api/api/cities/"+state,
			    type:"GET",
			    success: function(data){
			    	//alert(data['city']);
			    	var city_lists = '';
			    	city_lists ="<option value=''>--Select City--</option>";
			        for (var i = 0; i < data['city'].length; i++){
			    		city_lists += "<option value="+data['city'][i]['id']+">"+data['city'][i]['name']+"</option>";
			    	}	
			  		$('#city').html(city_lists);		      
			    },
			    error:function(data){
			        alert("error");
			    }
			});
	    });
</script>



